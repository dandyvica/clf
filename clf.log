14:38:25.390180152 [ INFO] using configuration file "tests/config/test1.yml"
14:38:25.390589483 [ INFO] options CliOptions { config_file: "tests/config/test1.yml", clf_logfile: None, delete_snapfile: true, check_conf: false }
14:40:54.828514499 [ INFO] using configuration file "tests/config/test1.yml"
14:40:54.829077767 [ INFO] options CliOptions { config_file: "tests/config/test1.yml", clf_logfile: None, delete_snapfile: true, check_conf: false }
14:40:54.829738599 [ INFO] deleting snapshot file "/tmp/snapshot.json"
14:40:54.830129840 [ INFO] loaded snapshot file "/tmp/snapshot.json", data = Snapshot { snapshot: {} }
14:40:54.830543328 [DEBUG] (1) clf: Config {
    global: GlobalOptions {
        path: "foo",
        outputdir: "/tmp",
        snapshotfile: "/tmp/snapshot.json",
        logger: "/data/projects/clf/clf.log",
    },
    searches: [
        Search {
            logfile: "/var/log/syslog",
            tags: [
                Tag {
                    name: "tag1",
                    options: SearchOptions {
                        runscript: false,
                        keepoutput: false,
                        rewind: false,
                        criticalthreshold: 0,
                        warningthreshold: 0,
                        logfilemissing: None,
                        protocol: false,
                        savethresholdcount: false,
                        sticky: 0,
                        dontbreak: false,
                    },
                    script: Some(
                        Cmd {
                            path: "/tmp/my_script.sh,",
                            args: Some(
                                [
                                    "arg1",
                                    "arg2",
                                    "arg3",
                                ],
                            ),
                            timeout: 7200,
                        },
                    ),
                    patterns: PatternSet {
                        critical: Some(
                            Pattern {
                                regexes: RegexVec(
                                    [
                                        error (\w+),
                                        (\w+):\s+Trying to associate with ([\w:]+),
                                    ],
                                ),
                                exceptions: None,
                            },
                        ),
                        warning: None,
                        ok: None,
                    },
                },
            ],
        },
    ],
}
14:40:54.836797453 [ INFO] searching for logfile="/var/log/syslog"
14:40:54.837211342 [DEBUG] (1) clf: calling or_insert() at line 138
14:40:54.837388803 [DEBUG] (1) clf: searching for tag=tag1
14:40:54.837633332 [ INFO] starting read from last offset=0, last line=0
14:40:54.909397820 [DEBUG] (1) rclf::logfile: found a match tag=tag1, re=(critical,error (\w+))
14:40:54.915581895 [DEBUG] (1) rclf::logfile: added variables: Vars({"CLF_LINE_NUMBER": "4", "CLF_CAPTURE1": "NXDOMAIN", "CLF_CAPTURE0": "error NXDOMAIN", "CLF_LINE": "May 17 11:22:26 bureau systemd-resolved[917]: Server returned error NXDOMAIN, mitigating potential DNS violation DVE-2018-0001, retrying transaction with reduced feature level UDP.\n"})
14:40:54.916781973 [ INFO] waiting for all threads to finish
14:40:54.916927659 [ INFO] end of searches
