global:
  path: "/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

searches:
  - logfile: 
      path: ./tests/integration/logfiles/small_access.log
      format: plain
    tags: 
      - name: tag1
        process: true
        options: rewind
        callback: { domain: ./tests/integration/tmp/callback.sock", args: ["arg1", "arg2", "arg3"] }
        patterns:
          critical: {
            regexes: ['GET\s+([/\w]+)\s+HTTP/1\.1"\s+(?P<code>\d+)\s+(?P<length>\d+)'],
            exceptions: ['AppleWebKit/537\.36']
          }
          warning: {
            regexes: ['POST\s+([/\w\.]+)\s+HTTP/1\.1"\s+(?P<code>\d+)\s+(?P<length>\d+)'],
            exceptions: ['^\d{2,3}\.']
          }