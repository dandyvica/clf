---
# a list of global options, valid for all searches.
global:
  # a list of ':'-separated list of paths (UNIX) or ';'-separated (Windows). If provided, the script is
  # searched within those directories.
  # Defaults to '/usr/sbin:/usr/bin:/sbin:/bin' or 'C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;' if not provided, depending on the 
  # platform.
  path: "/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

  # a path & file name where clf is keeping its runtime information. This is used to restart the search from the last
  # offset reached from the last clf run.
  snapshot_file: /tmp/snapshot.json

  # retention time for tags in seconds
  snapshot_retention: 5

  # a list of user variables, if any
  user_vars:
    first_name: Al
    last_name: Pacino
    city: 'Los Angeles'
    profession: actor


# a list of logfiles & tags, to search for patterns. This is either a list of logfiles, or a command giving back a list of 
# files to search for.
searches:
  # name & path of the logfile to search
  - logfile: tests/logfiles/tmplog

    # list of tags to refer to
    tags: 

      # tag name
      - name: error

        # a list of comma-separated options to manage the search. Current supported options are:
        # runcallback: if present, means the provided script will be called
        # rewind: restart the search from the beginning of the file
        options: "runcallback"

        # a script or command to be called, every time a hit is found.
        callback: { 
          path: "tests/scripts/echovars.py",
          args: ['arg1', 'arg2', 'arg3']
        }

        # list of patterns to match
        patterns:
          warning: {
            regexes: [
              'error',
            ],
            exceptions: [
              'STARTTLS'
            ]
          }